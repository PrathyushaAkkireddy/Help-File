<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Word Documentation Viewer</title>
<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
<style>
  body { margin:0; font-family: Arial, sans-serif; }
  .container { display:flex; height:100vh; }
  .sidebar { width:300px; border-right:1px solid #ccc; padding:10px; overflow-y:auto; background-color:#393a39; }
  .sidebar ul { list-style:none; padding-left:0; }
  .sidebar li { padding:6px 8px; cursor:pointer; border-radius:4px; user-select:none; color:#fff; }
  .sidebar li:hover, .sidebar li.active { background:#007acc; color:#fff; }
  .sidebar .parent::before { content:"▶ "; font-size:12px; }
  .sidebar .parent.expanded::before { content:"▼ "; }
  .children { margin-left:18px; display:none; }
  .children.show { display:block; }
  .content { flex:1; padding:25px; overflow-y:auto; }
  table { border-collapse:collapse; width:100%; }
  table, th, td { border:1px solid #333; padding:8px; }
  img { max-width:100%; }
  .sidebar-logo { text-align:center; padding:15px 10px; border-bottom:1px solid #555; margin-bottom:10px; }
  .sidebar-logo img { max-width:180px; height:auto; }
  .content {
  flex: 1;
  padding: 40px 20px;
  overflow-y: auto;
  background: #f9f9f9;
}
 
.content > * {
  max-width: 900px;     /* controls content width */
  margin-left: auto;
  margin-right: auto;
}
.content p {
  line-height: 1.7;
  margin-bottom: 16px;
  font-size: 15px;
}
 
.content h1, 
.content h2, 
.content h3 {
  margin-top: 32px;
  margin-bottom: 12px;
}
 
.content h1 {
  font-size: 26px;
}
 
.content h2 {
  font-size: 22px;
}
 
.content h3 {
  font-size: 18px;
}
 /* Center Figure captions */
.content p:has(img) {
  text-align: center;
}
 
/* Center text like "Figure 1", "Figure 2", "Table 1" */
.content p {
  text-align: left; /* default */
}
 
.content p:has(+ img),
.content p:has(+ table),
.content p:has(img) + p {
  text-align: center;
  font-weight: 600;
  margin-top: 8px;
  margin-bottom: 20px;
}
 
/* Center tables */
.content table {
  margin-left: auto;
  margin-right: auto;
}

 
/* Center table captions */
.content table + p,
.content p:has(+ table) {
  text-align: center;
  font-weight: 600;
}
.content img {
  border: 2px solid #000;
  padding:5px
}
/* Sub-sub section indentation */
.sidebar ul.children ul.children li {
  font-size: 13px;
  padding-left: 14px;
  opacity: 0.9;
}


</style>
</head>
<body>
 
<div class="container">
  <div class="sidebar">
    <div class="sidebar-logo">
      <img src="logo.png" alt="Company Logo">
    </div>
    <ul id="nav"></ul>
  </div>
  <div class="content" id="content"></div>
</div>
 
<script>
// Automatically load document.docx from the same folder
fetch('KPIT_HONDA_EE_VNA_HILFARM_TEST_BENCH_USER_MANUAL_(2).docx')
  .then(response => {
    if (!response.ok) throw new Error("Document not found");
    return response.arrayBuffer();
  })
  .then(arrayBuffer => mammoth.convertToHtml({ arrayBuffer }))
  .then(result => buildLayout(result.value))
  .catch(err => {
    console.error(err);
    document.getElementById('content').innerHTML = "<p style='color:red;'>Failed to load document. Make sure you are running this on a web server, not directly opening the HTML file.</p>";
  });
 

function buildLayout(html) {
  const temp = document.createElement("div");
  temp.innerHTML = html;
  const nav = document.getElementById("nav");
  const content = document.getElementById("content");
 
  nav.innerHTML = "";
  content.innerHTML = "";
 
  let started = false;
  let currentH1Children = null;
  let currentH2Children = null;
 
  Array.from(temp.children).forEach((el, index) => {
 
    // Start from Introduction
    if (!started) {
      if (el.tagName === "H1" &&
          el.innerText.trim().toLowerCase().includes("introduction")) {
        started = true;
      } else {
        return;
      }
    }
 
    // Assign IDs to headings
    if (/H[1-6]/.test(el.tagName)) {
      el.id = "heading-" + index;
    }
 
    /* =======================
       H1 (Parent)
    ======================= */
    if (el.tagName === "H1") {
      const li = document.createElement("li");
      li.textContent = el.innerText;
      li.classList.add("parent");
 
      const childrenUL = document.createElement("ul");
      childrenUL.classList.add("children");
 
      li.onclick = () => {
        childrenUL.classList.toggle("show");
        li.classList.toggle("expanded");
        scrollToHeading(el.id, li);
      };
 
      nav.appendChild(li);
      nav.appendChild(childrenUL);
 
      currentH1Children = childrenUL;
      currentH2Children = null;
    }
 
    /* =======================
       H2 (Sub-section)
    ======================= */
    else if (el.tagName === "H2" && currentH1Children) {
      const li = document.createElement("li");
      li.textContent = el.innerText;
      li.classList.add("parent");
 
      const childrenUL = document.createElement("ul");
      childrenUL.classList.add("children");
 
      li.onclick = (e) => {
        e.stopPropagation();
        childrenUL.classList.toggle("show");
        li.classList.toggle("expanded");
        scrollToHeading(el.id, li);
      };
 
      currentH1Children.appendChild(li);
      currentH1Children.appendChild(childrenUL);
 
      currentH2Children = childrenUL;
    }
 
    /* =======================
       H3 (Sub-sub-section)
    ======================= */
    else if (el.tagName === "H3" && currentH2Children) {
      const li = document.createElement("li");
      li.textContent = el.innerText;
 
      li.onclick = (e) => {
        e.stopPropagation();
        scrollToHeading(el.id, li);
      };
 
      currentH2Children.appendChild(li);
    }
 
    // Add content to main panel
    const cloned = el.cloneNode(true);
    content.appendChild(cloned);
 
    // Fix numbering AFTER content is added
    fixBrokenOrderedLists(content);
  });
}

function fixBrokenOrderedLists(container) {
  let lastOl = null;
  let counter = 1;
 
  Array.from(container.children).forEach(el => {
    if (el.tagName === "OL") {
      if (lastOl) {
        // Continue numbering
        el.start = counter;
      }
      counter += el.querySelectorAll("li").length;
      lastOl = el;
    } else if (
      el.tagName === "P" ||
      el.tagName === "IMG" ||
      el.tagName === "TABLE"
    ) {
      // allowed elements inside a list, do NOT reset
      return;
    } else {
      // any other element breaks the list
      lastOl = null;
      counter = 1;
    }
  });
}
 
 
function scrollToHeading(id, navItem) {
  document.querySelectorAll(".sidebar li")
    .forEach(li => li.classList.remove("active"));
 
  const target = document.getElementById(id);
  if (target) {
    target.scrollIntoView({ behavior: "smooth", block: "start" });
  }
 
  navItem.classList.add("active");
}
</script>
 
 
</body>
</html>
 

 
